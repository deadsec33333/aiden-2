function createPlayerList(divclass,idpodcast){const RSS_URL=idpodcast;const RSS_PODCAST="/pu_examiner/podcast_rss.php";$.ajax(RSS_PODCAST,{method:"GET",data:{rss:RSS_URL},accepts:{xml:"application/rss+xml"},dataType:"xml",success:function(data){$(data).find("item").each(function(i){const el=$(this);if(i===0){const template=`<div class="main-player" id="${divclass+"-player"}"><div id="player-content"><div class="player-body"><div class="podcast-image"><img loading="lazy" class="img-src" src="${el.find("itunes\\:image").attr("href")}" /></div><h2 class="player-header">${el.find("title").text()}</h2><audio data-status="ready" preload="none" id="${divclass+"-plrid_audio"}"> <source src="${el.find("enclosure").attr("url")}">Your browser does not support the audio tag.</audio><div id="${divclass+"-plrid_audio-audio-container"}" class="audio-player-container"><input class="audio-range" type="range" id="${divclass+"-plrid_audio-seek-slider"}" max="0" value="0"><div class="time-control"><span class="current-time" id="${divclass+"-plrid_audio-current-time"}" class="time">0:00</span><span class="duration-time" id="${divclass+"-plrid_audio-duration"}" class="time">${el.find("itunes\\:duration").text()}</span></div><div class="audio-control"><button class="rewind-btn" id="${divclass+"-plrid_audio-rew"}" onclick="document.getElementById('${divclass+"-plrid_audio"}').currentTime -= 15.0;"><<</button><button class="play-btn" id="${divclass+"-plrid_audio-play"}"><i class="fa fa-play">&#xf04b;</i></button><button class="ff-btn" id="${divclass+"-plrid_audio-ff"}">>></button></div><div class="v-control-slider"><input type="range" class="volume-slider" id="${divclass+"-plrid_audio-volume-slider"}" max="100" value="100"></div><div class="volume-control"><output class="vol-output" id="${divclass+"-plrid_audio-vol-output"}">100</output><button class="mute-btn" id="${divclass+"-plrid_audio-mute"}"><i class="fa fa-volume-up">&#xf028;</i></button></div></div></div></div><a class="podcast-faq" href="https://www.irishexaminer.com/podcast-faq/" target="_blank">FAQ</a></div><div class="${divclass+" player-list"}"><div data-class="${divclass}" data-img="${el.find("itunes\\:image").attr("href")}" data-audio="${el.find("enclosure").attr("url")}" data-title="${el.find("title").text()}" data-duration="${el.find("itunes\\:duration").text()}" class="podcast-item"><p>${el.find("title").text()}</p></div></div>`;$("."+divclass).append(template);let main_image_podcast=$("."+divclass).data("img");if(main_image_podcast!==undefined){let image_template=`<div class="main_image_podcast"><img alt="Podcast image" src="${main_image_podcast}" /></div>`;$("."+divclass+".player-layout-1").prepend(image_template);$("."+divclass+" .main-player").addClass("with_image");$("."+divclass).on("click",function(){$("."+divclass+" .main-player").removeClass("with_image");$("."+divclass+" .main_image_podcast").remove()})}let audio=$("#"+divclass+"-plrid_audio");let playButton=$("#"+divclass+"-plrid_audio-play");let playState="play";let muteState="unmute";let seekSlider=$("#"+divclass+"-plrid_audio-seek-slider");let volumeSlider=$("#"+divclass+"-plrid_audio-volume-slider");let audioContainer=$("#"+divclass+"-plrid_audio-audio-container");let currentTimeContainer=$("#"+divclass+"-plrid_audio-current-time");let volumeOutputContainer=$("#"+divclass+"-plrid_audio-vol-output");let fastforward=$("#"+divclass+"-plrid_audio-ff");let muteContainer=$("#"+divclass+"-plrid_audio-mute");let raf=null;if(audio[0].readyState>0){setSliderMax(seekSlider[0],audio[0])}else{audio[0].addEventListener("loadedmetadata",()=>{setSliderMax(seekSlider[0],audio[0])})}seekSlider[0].addEventListener("input",e=>{showRangeProgress(seekSlider[0],audioContainer,"seekSlider")});seekSlider[0].addEventListener("input",()=>{$(currentTimeContainer).text(calculateTime(seekSlider[0].value));if(!audio[0].paused){cancelAnimationFrame(raf)}});const displayBufferedAmount=()=>{let bufferedAmount=Math.floor(audio[0].buffered.end(audio[0].buffered.length-1));let bufferedAmountPer=bufferedAmount/seekSlider[0].max*100;$(audioContainer).css("--buffered-width",bufferedAmountPer+"%")};playButton[0].addEventListener("click",()=>{audio.data("status");if(playState==="play"){if(audio.attr("data-status")==="load"){audio.attr("data-status","ready");audio[0].load()}audio[0].play();playState="pause";$(playButton[0]).html('<i class="fa fa-pause">&#xf04c;</i>');requestAnimationFrame(whilePlaying)}else{audio[0].pause();playState="play";$(playButton[0]).html('<i class="fa fa-play">&#xf04b;</i>');cancelAnimationFrame(raf)}});seekSlider[0].addEventListener("change",()=>{audio[0].currentTime=seekSlider[0].value;if(!audio[0].paused){requestAnimationFrame(whilePlaying)}});fastforward[0].addEventListener("click",()=>{audio[0].currentTime+=15;requestAnimationFrame(whilePlaying)});const whilePlaying=()=>{seekSlider[0].value=Math.floor(audio[0].currentTime);$(currentTimeContainer).text(calculateTime(seekSlider[0].value));$(audioContainer).css("--seek-before-width",`${seekSlider[0].value/seekSlider[0].max*100}%`);raf=requestAnimationFrame(whilePlaying)};volumeSlider[0].addEventListener("input",e=>{showRangeProgress(volumeSlider[0],audioContainer,"volumeSlide");const value=e.target.value;$(volumeOutputContainer).text(value);audio[0].volume=value/100});muteContainer[0].addEventListener("click",()=>{if(muteState==="unmute"){audio[0].muted=true;muteState="mute";$(muteContainer).html('<i class="fa volume-off">&#xf026;</i>')}else{audio[0].muted=false;muteState="unmute";$(muteContainer).html('<i class="fa fa-volume-up">&#xf028;</i>')}})}else{const template=`<div data-class="${divclass}"  data-img="${el.find("itunes\\:image").attr("href")}" data-audio="${el.find("enclosure").attr("url")}" data-title="${el.find("title").text()}" data-duration="${el.find("itunes\\:duration").text()}" class="podcast-item"><p>${el.find("title").text()}</p>`;$("."+divclass+".player-list").append(template)}});$(".podcast-item").click(function(){let audio_src=$(this).data("audio");let img_src=$(this).data("img");let podcast_title=$(this).data("title");let podcast_duration=$(this).data("duration");let podcast_class=$(this).data("class");let podcast_audio=$("#"+divclass+"-plrid_audio");if(!podcast_audio[0].paused){$("#"+divclass+"-plrid_audio-play").trigger("click")}$("."+podcast_class+" img.img-src").attr("src",img_src);$("."+podcast_class+" .player-header").text(podcast_title);$("."+podcast_class+" source").attr("src",audio_src);podcast_audio.attr("data-status","load");$("."+podcast_class+" .duration-time").text(podcast_duration);$("."+podcast_class+" .current-time").text("0:00");let seekSlider=$("#"+divclass+"-plrid_audio-seek-slider");let audioContainer=$("#"+divclass+"-plrid_audio-audio-container");seekSlider[0].value=0;seekSlider[0].max=0;$(audioContainer).css("--seek-before-width",`0`)})}});setTimeout(()=>{if(typeof hidePremiumContent!=="undefined"){hidePremiumContent()}},8e3)}function createPlayerEpisode(divclass,idpodcast,idepisode,mode="inarticle"){const RSS_URL=idpodcast;const RSS_PODCAST="/pu_examiner/podcast_rss.php";$.ajax(RSS_PODCAST,{method:"GET",data:{rss:RSS_URL},accepts:{xml:"application/rss+xml"},dataType:"xml",success:function(data){$(data).find("item").each(function(i){const el=$(this);let episodeID=$(el.find("acast\\:episodeId"))[0].innerHTML;if(episodeID===idepisode){const template=`<div class="main-player player-in-article" id="${divclass+"-player"}"><div id="player-content"><div class="player-body"><div class="player-body-header"><div class="podcast-image"><img loading="lazy" class="img-src" src="${el.find("itunes\\:image").attr("href")}" /></div><h2 class="player-header">${el.find("title").text()}</h2></div><audio preload="none" id="${divclass+"-plrid_audio"}"> <source src="${el.find("enclosure").attr("url")}">Your browser does not support the audio tag.</audio><div id="${divclass+"-plrid_audio-audio-container"}" class="audio-player-container"><input class="audio-range" type="range" id="${divclass+"-plrid_audio-seek-slider"}" max="0" value="0"><div class="time-control"><span class="current-time" id="${divclass+"-plrid_audio-current-time"}" class="time">0:00</span><span class="duration-time" id="${divclass+"-plrid_audio-duration"}" class="time">${el.find("itunes\\:duration").text()}</span></div><div class="audio-control"><button class="rewind-btn" id="${divclass+"-plrid_audio-rew"}" onclick="document.getElementById('${divclass+"-plrid_audio"}').currentTime -= 15.0;"><<</button><button class="play-btn" id="${divclass+"-plrid_audio-play"}"><i class="fa fa-play">&#xf04b;</i></button><button class="ff-btn" id="${divclass+"-plrid_audio-ff"}">>></button></div><div class="v-control-slider"><input type="range" class="volume-slider" id="${divclass+"-plrid_audio-volume-slider"}" max="100" value="100"></div><div class="volume-control"><output class="vol-output" id="${divclass+"-plrid_audio-vol-output"}">100</output><button class="mute-btn" id="${divclass+"-plrid_audio-mute"}"><i class="fa fa-volume-up">&#xf028;</i></button></div></div></div></div><a class="podcast-faq" href="https://www.irishexaminer.com/podcast-faq/" target="_blank">FAQ</a></div></div>`;$("."+divclass).append(template);let audio=$("#"+divclass+"-plrid_audio");let playButton=$("#"+divclass+"-plrid_audio-play");let playState="play";let muteState="unmute";let seekSlider=$("#"+divclass+"-plrid_audio-seek-slider");let volumeSlider=$("#"+divclass+"-plrid_audio-volume-slider");let audioContainer=$("#"+divclass+"-plrid_audio-audio-container");let currentTimeContainer=$("#"+divclass+"-plrid_audio-current-time");let volumeOutputContainer=$("#"+divclass+"-plrid_audio-vol-output");let fastforward=$("#"+divclass+"-plrid_audio-ff");let muteContainer=$("#"+divclass+"-plrid_audio-mute");let raf=null;if(audio[0].readyState>0){setSliderMax(seekSlider[0],audio[0])}else{audio[0].addEventListener("loadedmetadata",()=>{setSliderMax(seekSlider[0],audio[0])})}seekSlider[0].addEventListener("input",e=>{showRangeProgress(seekSlider[0],audioContainer,"seekSlider")});seekSlider[0].addEventListener("input",()=>{$(currentTimeContainer).text(calculateTime(seekSlider[0].value));if(!audio[0].paused){cancelAnimationFrame(raf)}});const displayBufferedAmount=()=>{let bufferedAmount=Math.floor(audio[0].buffered.end(audio[0].buffered.length-1));let bufferedAmountPer=bufferedAmount/seekSlider[0].max*100;$(audioContainer).css("--buffered-width",bufferedAmountPer+"%")};playButton[0].addEventListener("click",()=>{if(playState==="play"){audio[0].play();playState="pause";$(playButton[0]).html('<i class="fa fa-pause">&#xf04c;</i>');requestAnimationFrame(whilePlaying)}else{audio[0].pause();playState="play";$(playButton[0]).html('<i class="fa fa-play">&#xf04b;</i>');cancelAnimationFrame(raf)}});seekSlider[0].addEventListener("change",()=>{audio[0].currentTime=seekSlider[0].value;if(!audio[0].paused){requestAnimationFrame(whilePlaying)}});fastforward[0].addEventListener("click",()=>{audio[0].currentTime+=15;requestAnimationFrame(whilePlaying)});const whilePlaying=()=>{seekSlider[0].value=Math.floor(audio[0].currentTime);$(currentTimeContainer).text(calculateTime(seekSlider[0].value));$(audioContainer).css("--seek-before-width",`${seekSlider[0].value/seekSlider[0].max*100}%`);raf=requestAnimationFrame(whilePlaying)};volumeSlider[0].addEventListener("input",e=>{showRangeProgress(volumeSlider[0],audioContainer,"volumeSlide");const value=e.target.value;$(volumeOutputContainer).text(value);audio[0].volume=value/100});muteContainer[0].addEventListener("click",()=>{if(muteState==="unmute"){audio[0].muted=true;muteState="mute";$(muteContainer).html('<i class="fa volume-off">&#xf026;</i>')}else{audio[0].muted=false;muteState="unmute";$(muteContainer).html('<i class="fa fa-volume-up">&#xf028;</i>')}})}})}});setTimeout(()=>{if(typeof hidePremiumContent!=="undefined"){hidePremiumContent()}},8e3)}let raf=null;const calculateTime=secs=>{const minutes=Math.floor(secs/60);const seconds=Math.floor(secs%60);const returnedSeconds=seconds<10?`0${seconds}`:`${seconds}`;return`${minutes}:${returnedSeconds}`};function setSliderMax(s,a){s.max=Math.floor(a.duration)}function showRangeProgress(rangeInput,audioContainer,nameInput){if(nameInput==="seekSlider"){$(audioContainer).css("--seek-before-width",rangeInput.value/rangeInput.max*100+"%")}else{$(audioContainer).css("--volume-before-width",rangeInput.value/rangeInput.max*100+"%")}}function generateSourceAndPreview(){let playerFormClass="g-player-with-list";$("."+playerFormClass).removeClass("was-validated");let RSS=$("."+playerFormClass+" #RSSurl");if(RSS[0].checkValidity()){let RSSurl=RSS.val();let RSSurlPart=RSSurl.split("/");let idPodcast=RSSurlPart.pop()||RSSurl.pop();let isPremium=$("."+playerFormClass+" #isPremium").prop("checked");let trackingLink=$("."+playerFormClass+" #trackingLink").val();let imageUrl=$("."+playerFormClass+" #IMGurl").val();let dataIMG="";let dataUTM="";let premiumBox="";if(isPremium){premiumBox="premium-box"}if(imageUrl){dataIMG='data-img="'+imageUrl+'"'}if(trackingLink){dataUTM='data-utm="'+trackingLink+'"'}let selectedLayout=$("."+playerFormClass+" #selectLayout").val();const selectUser=`<div class="mb-3"><h2 class="generator-headline">Preview</h2></div><div class="mb-3 form-floating"><select class="form-select" id="selectUser" aria-label="User State" data-class="${"episode-"+idPodcast}"> <option selected value="user-subscribed">Subscribed</option> <option value="user-loggedin">Logged In</option> <option value="user-loggedout">Logged Out</option></select><label for="floatingSelect">User State:</label></div>`;const playerSource=`<div class="${"episode-"+idPodcast+" "+selectedLayout+" "+premiumBox}" ${dataIMG} data-container-class="${"episode-"+idPodcast}" data-podcast-id="${idPodcast}" ${dataUTM}></div><script>createPlayerList('${"episode-"+idPodcast}', '${RSSurl}');</script>`;$("textarea#sourceCode").val("");$("textarea#sourceCode").val(playerSource);$(".col-right").empty();$(".col-right").append(selectUser);$(".col-right").append(playerSource);var highestTimeoutId=setTimeout(";");for(var i=0;i<highestTimeoutId;i++){clearTimeout(i)}setTimeout(()=>{let copy_link="https://www.irishexaminer.com/podcast/?podcast="+idPodcast+"&user=auth0%7C625035a69db2cd001915570c";const copy_podcast='<button class="btn-rss" onclick="copyRss(this)" data-href="'+copy_link+'"><span class="rss-info">Copied!</span>Copy RSS feed URL to listen on podcast players<i class="fa fa-rss">&#xf09e;</i></button>';$("#episode-"+idPodcast+"-player #player-content").append(copy_podcast)},500)}else{$("."+playerFormClass).addClass("was-validated")}$("#selectUser").on("change",function(){let playerClass=$("#selectUser").data("class");let dataIMG=$("."+playerClass).data("img");let utm_link=$("."+playerClass).data("utm");if(utm_link===undefined){utm_link="https://subscribe.irishexaminer.com/"}if(dataIMG!==undefined){let image_template=`<div class="main_image_podcast"><img alt="Podcast image" src="${dataIMG}" /></div>`;$("."+playerClass+" .main-player").removeClass("with_image");$("."+playerClass+" .main_image_podcast").remove();$("."+playerClass+".player-layout-1").prepend(image_template);$("."+playerClass+" .main-player").addClass("with_image");$("."+playerClass).on("click",function(){$("."+playerClass+" .main-player").removeClass("with_image");$("."+playerClass+" .main_image_podcast").remove()})}$(".p-content").remove();if(this.value==="user-loggedin"){$("."+playerClass+".premium-box").append('<div class="p-content"><p class="p-content-strap">This is exclusive subscriber content.</p><div class="p-contet-body"><img class="p-content-logo" loading="lazy" alt="IE Logo" src="/pu_examiner/images/IE_logo_180px.png" /><h2 class="p-content-title">Subscribe for the stories that matter.</h2><p class="p-content-subtitle">Read, listen and watch exclusive subscriber content.</p><a class="p-content-btn" href="'+utm_link+'" target="_blank">Subscribe now</a></div></div>')}else if(this.value==="user-loggedout"){$("."+playerClass+".premium-box").append('<div class="p-content"><p class="p-content-strap">This is exclusive subscriber content. </br>Already a subscriber? <a href="#"  onclick="cleanMG2();" data-mg2-action="login">Sign in</a></p><div class="p-contet-body"><img class="p-content-logo" loading="lazy" alt="IE Logo" src="/pu_examiner/images/IE_logo_180px.png" /><h2 class="p-content-title">Subscribe for the stories that matter.</h2><p class="p-content-subtitle">Read, listen and watch exclusive subscriber content.</p><a class="p-content-btn" href="'+utm_link+'" target="_blank">Subscribe now</a></div></div>')}})}function copySourceCode(e){copyHTML=$("textarea#"+e);copyHTML.select();navigator.clipboard.writeText(copyHTML.val())}function generateSourceAndPreviewBB(){let playerFormClass="g-player-bbcode";$("."+playerFormClass).removeClass("was-validated");let RSS=$("."+playerFormClass+" #RSSurlBB");let RSSID=$("."+playerFormClass+" #RSSIDBB");if(RSS[0].checkValidity()&&RSSID[0].checkValidity()){const playerBBCode=`[podcast=${RSSID.val()}]${RSS.val()}[/podcast]`;$("textarea#sourceBBCode").val("");$("textarea#sourceBBCode").val(playerBBCode);const playerBBScript=`<div class="episodeID-${RSSID.val()} player-layout-1 premium-box"></div><script>createPlayerEpisode('episodeID-${RSSID.val()}', '${RSS.val()}', '${RSSID.val()}');</script>`;$(".podcast-g-bbcode").empty();$(".podcast-g-bbcode").append(playerBBScript);var highestTimeoutId=setTimeout(";");for(var i=0;i<highestTimeoutId;i++){clearTimeout(i)}}else{$("."+playerFormClass).addClass("was-validated")}}